{% extends 'base.html' %}
{% load static %}

{% block stylesheet %}
<link rel="stylesheet" href="{% static 'css/datatable/dataTables.bootstrap4.min.css' %}">
<link rel="stylesheet" href="{% static 'css/openlayers/ol.css' %}" type="text/css">
{% endblock %}

{% block breadcrumb %}
<li class="breadcrumb-item active">Home</li>
{% endblock %}

{% block content %}
{% if events %}
<div id="map" class="map">
  <div id="popup"></div>
</div>
{% endif %}

<script type="text/javascript">
    $(document).ready(function() {
        $('#events_table').DataTable();
    });
</script>

<script src="{% static 'js/openlayers/ol.js' %}"></script>
<script src="{% static 'js/openlayers/olStationbook.js' %}"></script>

<table id="events_table" class="table" cellspacing="0" width="100%">
  <thead>
    <tr>
      <th>Origin time</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Depth</th>
      <th>Magnitude</th>
    </tr>
  </thead>
  <tbody>
    {% for e in events %}
    <tr>
      <td>{{ e.origin_time }}</td>
      <td>{{ e.origin_latitude }}</td>
      <td>{{ e.origin_longitude }}</td>
      <td>{{ e.origin_depth }}</td>
      <td>{{ e.magnitude_value }}</td>
    </tr>
    <script type="text/javascript">
      var latitude = parseFloat("{{ e.origin_latitude }}"),
          longitude = parseFloat("{{ e.origin_longitude }}"),
          markerPath = "{% static 'img/markers/marker-red.png' %}";
      if (!isNaN(latitude) && !isNaN(longitude)) {
          var point = new ol.Feature({
              geometry: new ol.geom.Point(ol.proj.fromLonLat([longitude, latitude])),
              name: `test`
          });
          point.setStyle(new ol.style.Style({
              image: new ol.style.Icon({
                  anchor: [.5, 46],
                  anchorXUnits: "fraction",
                  anchorYUnits: "pixels",
                  src: markerPath
              })
          })), vectorSource.addFeature(point)
      }
    </script>
    {% endfor %}
  </tbody>
</table>

<!-- <script type="text/javascript">
var latitude=parseFloat("{{ events.0.latitude }}"),longitude=parseFloat("{{ events.0.longitude }}");map.getView().setCenter(ol.proj.transform([longitude,latitude],"EPSG:4326","EPSG:3857")),map.getView().setZoom(8);
</script> -->

{% block javascript %}
<script src="{% static 'js/datatable/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'js/datatable/dataTables.bootstrap4.min.js' %}"></script>
{% endblock %}
{% endblock %}